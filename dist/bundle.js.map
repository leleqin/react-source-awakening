{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://react-source-awakening/./src/constants/index.js","webpack://react-source-awakening/./src/react/Component/index.js","webpack://react-source-awakening/./src/react/CreateElement/index.js","webpack://react-source-awakening/./src/react/DOM/createDOMElement.js","webpack://react-source-awakening/./src/react/DOM/index.js","webpack://react-source-awakening/./src/react/DOM/updateNodeElement.js","webpack://react-source-awakening/./src/react/Misc/Arrified/index.js","webpack://react-source-awakening/./src/react/Misc/CreateTaskQueue/index.js","webpack://react-source-awakening/./src/react/Misc/createReactInstance/index.js","webpack://react-source-awakening/./src/react/Misc/createStateNode/index.js","webpack://react-source-awakening/./src/react/Misc/getRoot/index.js","webpack://react-source-awakening/./src/react/Misc/getTag/index.js","webpack://react-source-awakening/./src/react/Misc/index.js","webpack://react-source-awakening/./src/react/index.js","webpack://react-source-awakening/./src/react/reconciliation/index.js","webpack://react-source-awakening/webpack/bootstrap","webpack://react-source-awakening/webpack/runtime/define property getters","webpack://react-source-awakening/webpack/runtime/hasOwnProperty shorthand","webpack://react-source-awakening/webpack/runtime/make namespace object","webpack://react-source-awakening/./src/index.js"],"sourcesContent":["export const FIBER_TAG = {\r\n  ROOT: \"host_root\",\r\n  COMPONENT: \"host_component\",\r\n  CLASS_COMPONENT: \"class_component\",\r\n  FUNCTION_COMPONENT: \"function_component\",\r\n};\r\n\r\nexport const EFFECT_TAG = {\r\n  PLACEMENT: \"placement\",\r\n  UPDATE: \"update\",\r\n  DELETE: \"delete\",\r\n};\r\n\r\nexport const VIRTUAL_DOM_TYPE = {\r\n  TEXT: \"text\",\r\n};\r\n","import { scheduleUpdate } from \"../reconciliation\";\r\n\r\nexport class Component {\r\n  constructor(props) {\r\n    this.props = props;\r\n  }\r\n\r\n  setState(partialState) {\r\n    scheduleUpdate(this, partialState);\r\n  }\r\n}\r\n","/**\r\n * @name 创建 Virtual DOM\r\n * @param {string} type 元素类型\r\n * @param {object | null} props 元素属性\r\n * @param  {createElement[]} children 元素的子元素\r\n * @returns {object} Virtual DOM\r\n *\r\n *  1. 处理文本节点结构，需要返回 Virtual DOM 结构\r\n *  2. 处理逻辑节点，刨除 bool 节点和 null 节点\r\n *  3. 通过 props 的 children 属性拿到子节点，将 children 放入 props 中\r\n */\r\nexport default function createElement(type, props, ...children) {\r\n  const childElement = [].concat(...children).reduce((result, child) => {\r\n    // 刨除 bool 节点和 null 节点\r\n    if (child !== false && child !== true && child !== null) {\r\n      if (child instanceof Object) result.push(child);\r\n      else result.push(createElement(\"text\", { textContent: child }));\r\n    }\r\n    return result;\r\n  }, []);\r\n  return {\r\n    type,\r\n    props: Object.assign({ children: childElement }, props),\r\n  };\r\n  // {\r\n  //   type: \"div\",\r\n  //   props: null,\r\n  //   children: [{type: 'text', props: {textContent: \"Hello\"}}]\r\n  // }\r\n}\r\n","import { VIRTUAL_DOM_TYPE } from \"../../constants\";\r\nimport updateNodeElement from \"./updateNodeElement\";\r\n\r\nconst createDOMElement = (virtualDOM) => {\r\n  let newElement = null;\r\n  if (virtualDOM.type === VIRTUAL_DOM_TYPE.TEXT) {\r\n    // 文本节点\r\n    newElement = document.createTextNode(virtualDOM.props.textContent);\r\n  } else {\r\n    // 元素节点\r\n    newElement = document.createElement(virtualDOM.type);\r\n    updateNodeElement(newElement, virtualDOM);\r\n  }\r\n  return newElement;\r\n};\r\n\r\nexport default createDOMElement;\r\n","export { default as createDOMElement } from \"./createDOMElement\";\r\nexport { default as updateNodeElement } from \"./updateNodeElement\";\r\n","/**\r\n * @name 给 DOM 元素设置属性\r\n * @param {object} newElement 新的 DOM 元素\r\n * @param {object} virtualDOM 新的 virtual DOM\r\n * @param {object} oldVirtualDOM 旧的 virtual DOM\r\n */\r\nexport default function updateNodeElement(\r\n  newElement,\r\n  virtualDOM,\r\n  oldVirtualDOM = {}\r\n) {\r\n  // 获取节点对应的属性对象\r\n  const newProps = virtualDOM.props || {};\r\n  const oldProps = oldVirtualDOM.props || {};\r\n\r\n  /**\r\n   * 文本节点处理\r\n   */\r\n  if (virtualDOM.type === \"text\") {\r\n    if (newProps.textContent !== oldProps.textContent) {\r\n      // 处理父节点类型更新的情况\r\n      if (virtualDOM.parent.type !== oldVirtualDOM.parent.type) {\r\n        virtualDOM.parent.stateNode.appendChild(\r\n          document.createTextNode(newProps.textContent)\r\n        );\r\n      } else {\r\n        // 父节点相同，替换文本\r\n        virtualDOM.parent.stateNode.replaceChild(\r\n          document.createTextNode(newProps.textContent),\r\n          oldVirtualDOM.stateNode\r\n        );\r\n      }\r\n    }\r\n    return;\r\n  }\r\n\r\n  Object.keys(newProps).forEach((propName) => {\r\n    // 获取属性值\r\n    const newPropsValue = newProps[propName];\r\n    const oldPropsValue = oldProps[propName];\r\n    if (newPropsValue !== oldPropsValue) {\r\n      // 判断属性是否为事件\r\n      if (propName.slice(0, 2) === \"on\") {\r\n        const eventName = propName.toLowerCase().slice(2);\r\n        newElement.addEventListener(eventName, newPropsValue);\r\n        if (oldPropsValue) {\r\n          newElement.removeEventListener(eventName, oldPropsValue);\r\n        }\r\n      } else if (propName === \"value\" || propName === \"checked\") {\r\n        newElement[propName] = newPropsValue;\r\n      } else if (propName !== \"children\") {\r\n        // 刨除 children 属性\r\n        if (propName === \"className\") {\r\n          newElement.setAttribute(\"class\", newPropsValue);\r\n        } else {\r\n          newElement.setAttribute(propName, newPropsValue);\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  /** 属性删除 */\r\n  Object.keys(oldProps).forEach((propsName) => {\r\n    // 获取属性值\r\n    const newPropsValue = newProps[propsName];\r\n    const oldPropsValue = oldProps[propsName];\r\n    // 属性被删除\r\n    if (!newPropsValue) {\r\n      if (propsName.slice(0, 2) === \"on\") {\r\n        const eventName = propsName.toLowerCase().slice(2);\r\n        newElement.removeEventListener(eventName, oldPropsValue);\r\n      } else if (propsName !== \"children\") {\r\n        newElement.removeAttribute(propsName);\r\n      }\r\n    }\r\n  });\r\n}\r\n","const arrified = (arg) => (Array.isArray(arg) ? arg : [arg]);\r\n\r\nexport default arrified;\r\n","const createTaskQueue = () => {\r\n  const taskQueue = [];\r\n\r\n  return {\r\n    /**\r\n     * @name 添加任务\r\n     * @param {object} item\r\n     */\r\n    push: (item) => taskQueue.push(item),\r\n\r\n    pop: () => taskQueue.shift(),\r\n    /**\r\n     * 判断当前任务队列是否为空\r\n     */\r\n    isEmpty: () => taskQueue.length === 0,\r\n  };\r\n};\r\n\r\nexport default createTaskQueue;\r\n","import { FIBER_TAG } from \"../../../constants\";\r\n\r\nexport const createReactInstance = (fiber) => {\r\n  let instance = null;\r\n  if (fiber.tag === FIBER_TAG.CLASS_COMPONENT) {\r\n    // 类组件, type 函数中存储的是构造函数\r\n    instance = new fiber.type(fiber.props);\r\n  } else {\r\n    // 函数组件\r\n    instance = fiber.type;\r\n  }\r\n\r\n  return instance;\r\n};\r\n","import { FIBER_TAG } from \"../../../constants\";\r\nimport { createDOMElement } from \"../../DOM\";\r\nimport { createReactInstance } from \"../createReactInstance\";\r\n\r\nconst createStateNode = (fiber) => {\r\n  if (fiber.tag === FIBER_TAG.COMPONENT) {\r\n    return createDOMElement(fiber);\r\n  } else {\r\n    // 区别类组件和函数组件\r\n    return createReactInstance(fiber);\r\n  }\r\n};\r\n\r\nexport default createStateNode;\r\n","const getRoot = (instance) => {\r\n  let fiber = instance.__fiber;\r\n  // 获取根节点的 fiber 对象\r\n  while (fiber.parent) {\r\n    fiber = fiber.parent;\r\n  }\r\n  return fiber;\r\n};\r\n\r\nexport default getRoot;\r\n","import { FIBER_TAG } from \"../../../constants\";\r\nimport { Component } from \"../../Component\";\r\n\r\nconst getTag = (virtualDOM) => {\r\n  // 普通节点\r\n  if (typeof virtualDOM.type === \"string\") {\r\n    return FIBER_TAG.COMPONENT;\r\n  } else if (Object.getPrototypeOf(virtualDOM.type) === Component) {\r\n    // 类组件节点\r\n    return FIBER_TAG.CLASS_COMPONENT;\r\n  } else {\r\n    // 函数组件\r\n    return FIBER_TAG.FUNCTION_COMPONENT;\r\n  }\r\n};\r\n\r\nexport default getTag;\r\n","export { default as createTaskQueue } from \"./CreateTaskQueue\";\r\nexport { default as arrified } from \"./Arrified\";\r\nexport { default as createStateNode } from \"./createStateNode\";\r\nexport { default as getTag } from \"./getTag\";\r\nexport { default as getRoot } from \"./getRoot\";\r\n","import createElement from \"./CreateElement\";\r\n\r\nexport { render } from \"./reconciliation\";\r\nexport { Component } from \"./Component\";\r\n\r\nexport default {\r\n  createElement,\r\n};\r\n","/**\r\n *\r\n * @param {*} element\r\n * @param {*} dom\r\n *\r\n * 1. 向任务队列中添加任务\r\n *  - 任务：通过 Virtual DOM 构建 Fiber 对象\r\n * 2. 指定在浏览器空闲时间执行 requestIdleCallback\r\n *  - a. 执行任务\r\n *  - b. 判断是否任务中断或者 taskQueue 有任务，再次使浏览器在空闲时间执行任务\r\n */\r\n\r\nimport { EFFECT_TAG, FIBER_TAG } from \"../../constants\";\r\nimport { updateNodeElement } from \"../DOM\";\r\nimport {\r\n  createTaskQueue,\r\n  arrified,\r\n  createStateNode,\r\n  getTag,\r\n  getRoot,\r\n} from \"../Misc\";\r\n\r\nconst taskQueue = createTaskQueue();\r\n\r\n// 子任务\r\nlet subTask = null;\r\n\r\n// 拿到最外层的 fiber。为后面拿到 effects 循环构建真实 DOM 做准备\r\nlet pendingCommit = null;\r\n\r\n/**\r\n * @name 生成真实 DOM 对象\r\n * @param {object} fiber **根节点** 的 fiber 对象\r\n */\r\nconst commitAllWork = (fiber) => {\r\n  /**\r\n   * 遍历所有 fiber 对象，即 effects 数组。构建真实 DOM 对象\r\n   *\r\n   * 1. 普通节点\r\n   * 最外层的 fiber 对象包含所有元素的 fiber 对象\r\n   *\r\n   * 2. 类组件节点\r\n   * 类组件本身无法追加真实 DOM。需要找到类组件的普通父级，\r\n   * 往 DOM 元素中追加类组件返回的内容\r\n   *\r\n   * 3. 函数组件节点\r\n   * 同类组件，找到函数组件的普通父级\r\n   */\r\n  fiber.effects.forEach((f) => {\r\n    // 为更新组件状态；将组件的 fiber 对象备份到组件的实例对象上\r\n    if (f.tag === FIBER_TAG.CLASS_COMPONENT) {\r\n      f.stateNode.__fiber = f;\r\n    }\r\n\r\n    if (f.effectTag === EFFECT_TAG.DELETE) {\r\n      f.parent.stateNode.removeChild(f.stateNode);\r\n    } else if (f.effectTag === EFFECT_TAG.UPDATE) {\r\n      /**\r\n       * 判断是不是同一种类型节点\r\n       */\r\n      if (f.type === f.alternate.type) {\r\n        /**\r\n         * 节点类型相同，更新 DOM\r\n         * @param 要更新的 DOM 节点\r\n         * @param 新的 virtual DOM\r\n         * @param 旧的 virtual DOM\r\n         */\r\n        updateNodeElement(f.stateNode, f, f.alternate);\r\n      } else {\r\n        /**\r\n         * 节点类型不同，直接替换\r\n         * @param 新节点 stateNode\r\n         * @param 旧节点的 stateNode\r\n         */\r\n        f.parent.stateNode.replaceChild(f.stateNode, f.alternate.stateNode);\r\n      }\r\n    } else if (f.effectTag === EFFECT_TAG.PLACEMENT) {\r\n      /**\r\n       * 当前要追加的子节点\r\n       */\r\n      let tempFiber = f;\r\n      /**\r\n       * 当前要追加的子节点的父级\r\n       */\r\n      let parentFiber = f.parent;\r\n      while (\r\n        parentFiber.tag === FIBER_TAG.CLASS_COMPONENT ||\r\n        parentFiber.tag === FIBER_TAG.FUNCTION_COMPONENT\r\n      ) {\r\n        parentFiber = parentFiber.parent;\r\n      }\r\n      /**\r\n       * 如果子节点是普通节点，找到父级，将子节点追加到父级中\r\n       */\r\n      if (tempFiber.tag === FIBER_TAG.COMPONENT) {\r\n        parentFiber.stateNode.append(tempFiber.stateNode);\r\n      }\r\n    }\r\n  });\r\n\r\n  /**\r\n   * 备份旧的 fiber 对象，以便后面更新使用\r\n   */\r\n  fiber.stateNode.__rootFiberContainer = fiber;\r\n};\r\n\r\nconst getFirstTask = () => {\r\n  // 从任务队列中获取任务\r\n  const task = taskQueue.pop();\r\n\r\n  /**\r\n   * 判断是否是组件更新任务\r\n   */\r\n  if (task.from === FIBER_TAG.CLASS_COMPONENT) {\r\n    /**\r\n     * 根据已经存在的最外层的 fiber 对象构建，构建更新的根节点 fiber 对象\r\n     */\r\n    // 获取组件 fiber 对象\r\n    const root = getRoot(task.instance);\r\n    // 存储要更新的状态\r\n    task.instance.__fiber.partialState = task.partialState;\r\n    return {\r\n      props: root.props,\r\n      stateNode: root.stateNode,\r\n      tag: FIBER_TAG.ROOT,\r\n      effects: [],\r\n      child: null,\r\n      // 备份 fiber 对象\r\n      alternate: root,\r\n    };\r\n  }\r\n\r\n  // 获取根节点，返回根节点的 fiber 对象\r\n  return {\r\n    props: task.props,\r\n    stateNode: task.dom,\r\n    tag: FIBER_TAG.ROOT,\r\n    effects: [],\r\n    child: null,\r\n    // 备份 fiber 对象\r\n    alternate: task.dom.__rootFiberContainer,\r\n  };\r\n};\r\n\r\nconst reconcileChildren = (fiber, children) => {\r\n  /**\r\n   * children 可能是数组 | 对象\r\n   * 将 children 转换为数组\r\n   */\r\n  const arrifiedChildren = arrified(children);\r\n  // 拿到数组中的 virtual DOM 转化为 fiber\r\n  let index = 0;\r\n  let childrenLength = arrifiedChildren.length;\r\n  let element = null;\r\n  let newFiber = null;\r\n  // 临时存储，用来记录上一个 fiber\r\n  let preFiber = null;\r\n\r\n  /**\r\n   * 备份 fiber\r\n   * fiber.alternate.child 是 children 数组中的第一个子节点的备份节点\r\n   * children 数组中第一个是 child，其余的是 sibling 节点\r\n   */\r\n  let alternate = null;\r\n  if (fiber.alternate && fiber.alternate.child) {\r\n    alternate = fiber.alternate.child;\r\n  }\r\n\r\n  while (index < childrenLength || alternate) {\r\n    element = arrifiedChildren[index];\r\n\r\n    if (!element && alternate) {\r\n      // 删除节点\r\n      // 备份属性的 effectTag 设置为 delete\r\n      alternate.effectTag = EFFECT_TAG.DELETE;\r\n      fiber.effects.push(alternate);\r\n    } else if (element && alternate) {\r\n      // 更新节点\r\n      newFiber = {\r\n        type: element.type,\r\n        props: element.props,\r\n        tag: getTag(element),\r\n        effects: [],\r\n        effectTag: EFFECT_TAG.UPDATE,\r\n        parent: fiber,\r\n        alternate,\r\n      };\r\n      if (element.type === alternate.type) {\r\n        /**\r\n         * 类型相同\r\n         * 旧的 stateNode 直接赋值给新的 stateNode\r\n         */\r\n        newFiber.stateNode = alternate.stateNode;\r\n      } else {\r\n        /**\r\n         * 类型不同\r\n         * 直接创建节点\r\n         */\r\n        newFiber.stateNode = createStateNode(newFiber);\r\n      }\r\n    } else if (element && !alternate) {\r\n      // 新建节点\r\n      newFiber = {\r\n        type: element.type,\r\n        props: element.props,\r\n        tag: getTag(element),\r\n        effects: [],\r\n        effectTag: EFFECT_TAG.PLACEMENT,\r\n        parent: fiber,\r\n      };\r\n\r\n      /**\r\n       * 为 fiber 对象添加 DOM 对象或组件实例对象\r\n       * 若是普通节点 stateNode 是 DOM 对象\r\n       * 若是类组件 stateNode 是组件实例对象\r\n       */\r\n      newFiber.stateNode = createStateNode(newFiber);\r\n    }\r\n\r\n    // 判断当前 fiber 是上一个 fiber 的 parent 还是 sibling\r\n    if (index === 0) {\r\n      fiber.child = newFiber;\r\n    } else if (element) {\r\n      // 如果不是第一个 child，说明其他的 child 是上一个 child 的 sibling\r\n      preFiber.sibling = newFiber;\r\n    }\r\n\r\n    // 更新备份节点，兄弟节点备份\r\n    if (alternate && alternate.sibling) {\r\n      alternate = alternate.sibling;\r\n    } else {\r\n      alternate = null;\r\n    }\r\n\r\n    preFiber = newFiber;\r\n\r\n    index++;\r\n  }\r\n};\r\n\r\nconst executeTask = (fiber) => {\r\n  /**\r\n   * 构建子级 fiber 对象\r\n   */\r\n  if (fiber.tag === FIBER_TAG.CLASS_COMPONENT) {\r\n    /**\r\n     * 更新组件状态，以便后面的 render 返回更新状态的 jsx\r\n     */\r\n    // 实例对象获取组件的 fiber 对象\r\n    if (fiber.stateNode.__fiber && fiber.stateNode.__fiber.partialState) {\r\n      fiber.stateNode.state = {\r\n        ...fiber.stateNode.state,\r\n        ...fiber.stateNode.__fiber.partialState,\r\n      };\r\n    }\r\n    // 类组件，children 是 render 返回的元素\r\n    reconcileChildren(fiber, fiber.stateNode.render());\r\n  } else if (fiber.tag === FIBER_TAG.FUNCTION_COMPONENT) {\r\n    // 函数组件，children 是 render 返回的元素\r\n    reconcileChildren(fiber, fiber.stateNode(fiber.props));\r\n  } else {\r\n    reconcileChildren(fiber, fiber.props.children);\r\n  }\r\n  /**\r\n   * 如果子级存在 返回子级\r\n   * 将这个子级当作父级 构建这个父级下的子级\r\n   * 一直递归下去，能得到所有左侧节点的 fiber 对象\r\n   */\r\n  if (fiber.child) {\r\n    return fiber.child;\r\n  }\r\n\r\n  /**\r\n   * 如果有同级 返回同级\r\n   * 如果有父级 退回到父级,再看父级有没有同级\r\n   * 保证每个节点都找到了\r\n   */\r\n  let currentExecuterFiber = fiber;\r\n  while (currentExecuterFiber.parent) {\r\n    /**\r\n     * 使最外层的 effects 存储所有 fiber 对象\r\n     */\r\n    currentExecuterFiber.parent.effects =\r\n      currentExecuterFiber.parent.effects.concat(\r\n        currentExecuterFiber.effects.concat([currentExecuterFiber])\r\n      );\r\n\r\n    if (currentExecuterFiber.sibling) {\r\n      return currentExecuterFiber.sibling;\r\n    }\r\n    currentExecuterFiber = currentExecuterFiber.parent;\r\n  }\r\n\r\n  // 最外层 fiber 对象\r\n  pendingCommit = currentExecuterFiber;\r\n};\r\n\r\nconst workLoop = (deadline) => {\r\n  if (!subTask) {\r\n    // 若当前无任务，获取执行任务\r\n    subTask = getFirstTask();\r\n  }\r\n\r\n  // 当有任务并且空闲时间大于 1 ms 时执行任务\r\n  while (subTask && deadline.timeRemaining() > 1) {\r\n    // 执行任务 并返回一个新任务 while 执行\r\n    subTask = executeTask(subTask);\r\n  }\r\n\r\n  /**\r\n   * 判断\r\n   */\r\n  if (pendingCommit) {\r\n    commitAllWork(pendingCommit);\r\n  }\r\n};\r\n\r\nconst performTask = (deadline) => {\r\n  // 执行任务队列\r\n  workLoop(deadline);\r\n\r\n  /**\r\n   * 判断任务是否存在\r\n   * 当任务被中断时，需要重新判断执行的任务是否有中断\r\n   * 或者 taskQueue 有任务\r\n   * 告知浏览器在空闲时间继续执行\r\n   */\r\n  if (subTask || !taskQueue.isEmpty()) {\r\n    requestIdleCallback(performTask);\r\n  }\r\n};\r\n\r\nexport const render = (element, dom) => {\r\n  // 构建 Fiber 对象，从顶层开始\r\n  taskQueue.push({\r\n    dom,\r\n    props: { children: element },\r\n  });\r\n\r\n  // 浏览器空闲时间执行任务\r\n  requestIdleCallback(performTask);\r\n};\r\n\r\n/**\r\n * @name 更新状态\r\n * @param {*} instance 组件实例对象\r\n * @param {*} partialState 要更新的值\r\n */\r\nexport const scheduleUpdate = (instance, partialState) => {\r\n  // 将 partialState 的值覆盖原本的值\r\n  /**\r\n   * 1. 将组件状态更新加入任务\r\n   * 2. 和其他任务做区分 from\r\n   */\r\n  taskQueue.push({\r\n    from: FIBER_TAG.CLASS_COMPONENT,\r\n    instance,\r\n    partialState,\r\n  });\r\n\r\n  // 浏览器空闲时间执行任务\r\n  requestIdleCallback(performTask);\r\n};\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React, { render, Component } from \"./react\";\r\n\r\nconst root = document.getElementById(\"root\");\r\n\r\nconst jsx = (\r\n  <div>\r\n    <p>Hello React</p>\r\n    <p>Hi fiber</p>\r\n  </div>\r\n);\r\n\r\n// render(jsx, root);\r\n\r\n// // 模拟更新操作\r\n// setTimeout(() => {\r\n//   const jsxUpdate = (\r\n//     <div>\r\n//       {/* <div>更新</div> */}\r\n//       <p>Hi fiber</p>\r\n//     </div>\r\n//   );\r\n//   render(jsxUpdate, root);\r\n// }, 2000);\r\n\r\n/**\r\n * 渲染类组件\r\n */\r\nclass Grating extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      name: \"张三\",\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.props.title}hahaha{this.state.name}\r\n        <button onClick={() => this.setState({ name: \"李四\" })}>button</button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nrender(<Grating title=\"hello\" />, root);\r\n\r\n/**\r\n * 渲染函数组件\r\n */\r\n\r\nfunction FnComponent(props) {\r\n  return <div>{props.title}函数组件</div>;\r\n}\r\n\r\n// render(<FnComponent title=\"hello\" />, root);\r\n"],"names":["FIBER_TAG","ROOT","COMPONENT","CLASS_COMPONENT","FUNCTION_COMPONENT","EFFECT_TAG","PLACEMENT","UPDATE","DELETE","VIRTUAL_DOM_TYPE","TEXT","scheduleUpdate","Component","props","_classCallCheck","_createClass","key","value","setState","partialState","createElement","type","_ref","_len","arguments","length","children","Array","_key","childElement","concat","apply","reduce","result","child","Object","push","textContent","assign","updateNodeElement","createDOMElement","virtualDOM","newElement","document","createTextNode","default","oldVirtualDOM","undefined","newProps","oldProps","parent","stateNode","appendChild","replaceChild","keys","forEach","propName","newPropsValue","oldPropsValue","slice","eventName","toLowerCase","addEventListener","removeEventListener","setAttribute","propsName","removeAttribute","arrified","arg","isArray","createTaskQueue","taskQueue","item","pop","shift","isEmpty","createReactInstance","fiber","instance","tag","createStateNode","getRoot","__fiber","getTag","getPrototypeOf","render","subTask","pendingCommit","commitAllWork","effects","f","effectTag","removeChild","alternate","tempFiber","parentFiber","append","__rootFiberContainer","getFirstTask","task","from","root","dom","reconcileChildren","arrifiedChildren","index","childrenLength","element","newFiber","preFiber","sibling","executeTask","state","_objectSpread","currentExecuterFiber","workLoop","deadline","timeRemaining","performTask","requestIdleCallback","React","getElementById","jsx","Grating","_Component","_this","_callSuper","name","_inherits","_this2","title","onClick","FnComponent"],"sourceRoot":""}