{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://react-source-awakening/./src/constants/index.js","webpack://react-source-awakening/./src/react/Component/index.js","webpack://react-source-awakening/./src/react/CreateElement/index.js","webpack://react-source-awakening/./src/react/DOM/createDOMElement.js","webpack://react-source-awakening/./src/react/DOM/index.js","webpack://react-source-awakening/./src/react/DOM/updateNodeElement.js","webpack://react-source-awakening/./src/react/Misc/Arrified/index.js","webpack://react-source-awakening/./src/react/Misc/CreateTaskQueue/index.js","webpack://react-source-awakening/./src/react/Misc/createReactInstance/index.js","webpack://react-source-awakening/./src/react/Misc/createStateNode/index.js","webpack://react-source-awakening/./src/react/Misc/getTag/index.js","webpack://react-source-awakening/./src/react/Misc/index.js","webpack://react-source-awakening/./src/react/index.js","webpack://react-source-awakening/./src/react/reconciliation/index.js","webpack://react-source-awakening/webpack/bootstrap","webpack://react-source-awakening/webpack/runtime/define property getters","webpack://react-source-awakening/webpack/runtime/hasOwnProperty shorthand","webpack://react-source-awakening/webpack/runtime/make namespace object","webpack://react-source-awakening/./src/index.js"],"sourcesContent":["export const FIBER_TAG = {\r\n  ROOT: \"host_root\",\r\n  COMPONENT: \"host_component\",\r\n  CLASS_COMPONENT: \"class_component\",\r\n  FUNCTION_COMPONENT: \"function_component\",\r\n};\r\n\r\nexport const EFFECT_TAG = {\r\n  PLACEMENT: \"placement\",\r\n};\r\n\r\nexport const VIRTUAL_DOM_TYPE = {\r\n  TEXT: \"text\",\r\n};\r\n","export class Component {\r\n  constructor(props) {\r\n    this.props = props;\r\n  }\r\n}\r\n","/**\r\n * @name 创建 Virtual DOM\r\n * @param {string} type 元素类型\r\n * @param {object | null} props 元素属性\r\n * @param  {createElement[]} children 元素的子元素\r\n * @returns {object} Virtual DOM\r\n *\r\n *  1. 处理文本节点结构，需要返回 Virtual DOM 结构\r\n *  2. 处理逻辑节点，刨除 bool 节点和 null 节点\r\n *  3. 通过 props 的 children 属性拿到子节点，将 children 放入 props 中\r\n */\r\nexport default function createElement(type, props, ...children) {\r\n  const childElement = [].concat(...children).reduce((result, child) => {\r\n    // 刨除 bool 节点和 null 节点\r\n    if (child !== false && child !== true && child !== null) {\r\n      if (child instanceof Object) result.push(child);\r\n      else result.push(createElement(\"text\", { textContent: child }));\r\n    }\r\n    return result;\r\n  }, []);\r\n  return {\r\n    type,\r\n    props: Object.assign({ children: childElement }, props),\r\n  };\r\n  // {\r\n  //   type: \"div\",\r\n  //   props: null,\r\n  //   children: [{type: 'text', props: {textContent: \"Hello\"}}]\r\n  // }\r\n}\r\n","import { VIRTUAL_DOM_TYPE } from \"../../constants\";\r\nimport updateNodeElement from \"./updateNodeElement\";\r\n\r\nconst createDOMElement = (virtualDOM) => {\r\n  let newElement = null;\r\n  if (virtualDOM.type === VIRTUAL_DOM_TYPE.TEXT) {\r\n    // 文本节点\r\n    newElement = document.createTextNode(virtualDOM.props.textContent);\r\n  } else {\r\n    // 元素节点\r\n    newElement = document.createElement(virtualDOM.type);\r\n    updateNodeElement(newElement, virtualDOM);\r\n  }\r\n  return newElement;\r\n};\r\n\r\nexport default createDOMElement;\r\n","export { default as createDOMElement } from \"./createDOMElement\";\r\nexport { default as updateNodeElement } from \"./updateNodeElement\";\r\n","/**\r\n * @name 给 DOM 元素设置属性\r\n * @param {object} newElement 新的 DOM 元素\r\n * @param {object} virtualDOM\r\n */\r\nexport default function updateNodeElement(newElement, virtualDOM) {\r\n  // 获取节点对应的属性对象\r\n  const newProps = virtualDOM.props;\r\n  Object.keys(newProps).forEach((propName) => {\r\n    // 获取属性值\r\n    const newPropsValue = newProps[propName];\r\n    // 判断属性是否为事件\r\n    if (propName.slice(0, 2) === \"on\") {\r\n      const eventName = propName.toLowerCase().slice(2);\r\n      newElement.addEventListener(eventName, newPropsValue);\r\n    } else if (propName === \"value\" || propName === \"checked\") {\r\n      newElement[propName] = newPropsValue;\r\n    } else if (propName !== \"children\") {\r\n      // 刨除 children 属性\r\n      if (propName === \"className\") {\r\n        newElement.setAttribute(\"class\", newPropsValue);\r\n      } else {\r\n        newElement.setAttribute(propName, newPropsValue);\r\n      }\r\n    }\r\n  });\r\n}\r\n","const arrified = (arg) => (Array.isArray(arg) ? arg : [arg]);\r\n\r\nexport default arrified;\r\n","const createTaskQueue = () => {\r\n  const taskQueue = [];\r\n\r\n  return {\r\n    /**\r\n     * @name 添加任务\r\n     * @param {object} item\r\n     */\r\n    push: (item) => taskQueue.push(item),\r\n\r\n    pop: () => taskQueue.shift(),\r\n    /**\r\n     * 判断当前任务队列是否为空\r\n     */\r\n    isEmpty: () => taskQueue.length === 0,\r\n  };\r\n};\r\n\r\nexport default createTaskQueue;\r\n","import { FIBER_TAG } from \"../../../constants\";\r\n\r\nexport const createReactInstance = (fiber) => {\r\n  let instance = null;\r\n  if (fiber.tag === FIBER_TAG.CLASS_COMPONENT) {\r\n    // 类组件, type 函数中存储的是构造函数\r\n    instance = new fiber.type(fiber.props);\r\n  } else {\r\n    // 函数组件\r\n    instance = fiber.type;\r\n  }\r\n\r\n  return instance;\r\n};\r\n","import { FIBER_TAG } from \"../../../constants\";\r\nimport { createDOMElement } from \"../../DOM\";\r\nimport { createReactInstance } from \"../createReactInstance\";\r\n\r\nconst createStateNode = (fiber) => {\r\n  if (fiber.tag === FIBER_TAG.COMPONENT) {\r\n    return createDOMElement(fiber);\r\n  } else {\r\n    // 区别类组件和函数组件\r\n    return createReactInstance(fiber);\r\n  }\r\n};\r\n\r\nexport default createStateNode;\r\n","import { FIBER_TAG } from \"../../../constants\";\r\nimport { Component } from \"../../Component\";\r\n\r\nconst getTag = (virtualDOM) => {\r\n  // 普通节点\r\n  if (typeof virtualDOM.type === \"string\") {\r\n    return FIBER_TAG.COMPONENT;\r\n  } else if (Object.getPrototypeOf(virtualDOM.type) === Component) {\r\n    // 类组件节点\r\n    return FIBER_TAG.CLASS_COMPONENT;\r\n  } else {\r\n    // 函数组件\r\n    return FIBER_TAG.FUNCTION_COMPONENT;\r\n  }\r\n};\r\n\r\nexport default getTag;\r\n","export { default as createTaskQueue } from \"./CreateTaskQueue\";\r\nexport { default as arrified } from \"./Arrified\";\r\nexport { default as createStateNode } from \"./createStateNode\";\r\nexport { default as getTag } from \"./getTag\";\r\n","import createElement from \"./CreateElement\";\r\n\r\nexport { render } from \"./reconciliation\";\r\nexport { Component } from \"./Component\";\r\n\r\nexport default {\r\n  createElement,\r\n};\r\n","/**\r\n *\r\n * @param {*} element\r\n * @param {*} dom\r\n *\r\n * 1. 向任务队列中添加任务\r\n *  - 任务：通过 Virtual DOM 构建 Fiber 对象\r\n * 2. 指定在浏览器空闲时间执行 requestIdleCallback\r\n *  - a. 执行任务\r\n *  - b. 判断是否任务中断或者 taskQueue 有任务，再次使浏览器在空闲时间执行任务\r\n */\r\n\r\nimport { EFFECT_TAG, FIBER_TAG } from \"../../constants\";\r\nimport { createTaskQueue, arrified, createStateNode, getTag } from \"../Misc\";\r\n\r\nconst taskQueue = createTaskQueue();\r\n\r\n// 子任务\r\nlet subTask = null;\r\n\r\n// 拿到最外层的 fiber。为后面拿到 effects 循环构建真实 DOM 做准备\r\nlet pendingCommit = null;\r\n\r\nconst commitAllWork = (fiber) => {\r\n  /**\r\n   * 遍历 fiber 对象，构建真实 DOM 对象\r\n   *\r\n   * 1. 普通节点\r\n   * 最外层的 fiber 对象包含所有元素的 fiber 对象\r\n   *\r\n   * 2. 类组件节点\r\n   * 类组件本身无法追加真实 DOM。需要找到类组件的父级，\r\n   * 类组件的父级不是一个组件，而是一个普通的 DOM 元素，\r\n   * 往 DOM 元素中追加类组件返回的内容\r\n   */\r\n  fiber.effects.forEach((f) => {\r\n    if (f.effectTag === EFFECT_TAG.PLACEMENT) {\r\n      let tempFiber = f;\r\n      let parentFiber = f.parent;\r\n      while (parentFiber.tag === FIBER_TAG.CLASS_COMPONENT) {\r\n        parentFiber = parentFiber.parent;\r\n      }\r\n      if (tempFiber.tag === FIBER_TAG.COMPONENT) {\r\n        parentFiber.stateNode.append(tempFiber.stateNode);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nconst getFirstTask = () => {\r\n  // 从任务队列中获取任务\r\n  const task = taskQueue.pop();\r\n\r\n  // 获取根节点，返回根节点的 fiber 对象\r\n  return {\r\n    props: task.props,\r\n    stateNode: task.dom,\r\n    tag: FIBER_TAG.ROOT,\r\n    effects: [],\r\n    child: null,\r\n  };\r\n};\r\n\r\nconst reconcileChildren = (fiber, children) => {\r\n  /**\r\n   * children 可能是数组 | 对象\r\n   * 将 children 转换为数组\r\n   */\r\n  const arrifiedChildren = arrified(children);\r\n  // 拿到数组中的 virtual DOM 转化为 fiber\r\n  let index = 0;\r\n  let childrenLength = arrifiedChildren.length;\r\n  let element = null;\r\n  let newFiber = null;\r\n  // 临时存储，用来记录上一个 fiber\r\n  let preFiber = null;\r\n\r\n  while (index < childrenLength) {\r\n    element = arrifiedChildren[index];\r\n    newFiber = {\r\n      type: element.type,\r\n      props: element.props,\r\n      tag: getTag(element),\r\n      effects: [],\r\n      effectTag: EFFECT_TAG.PLACEMENT,\r\n      parent: fiber,\r\n    };\r\n\r\n    /**\r\n     * 为 fiber 对象添加 DOM 对象或组件实例对象\r\n     * 若是普通节点 stateNode 是 DOM 对象\r\n     * 若是类组件 stateNode 是组件实例对象\r\n     */\r\n    newFiber.stateNode = createStateNode(newFiber);\r\n\r\n    // 判断当前 fiber 是上一个 fiber 的 parent 还是 sibling\r\n    if (index === 0) {\r\n      fiber.child = newFiber;\r\n    } else {\r\n      // 如果不是第一个 child，说明其他的 child 是上一个 child 的 sibling\r\n      preFiber.sibling = newFiber;\r\n    }\r\n\r\n    preFiber = newFiber;\r\n\r\n    index++;\r\n  }\r\n};\r\n\r\nconst executeTask = (fiber) => {\r\n  /**\r\n   * 构建子级 fiber 对象\r\n   */\r\n  if (fiber.tag === FIBER_TAG.CLASS_COMPONENT) {\r\n    // 类组件，children 是 render 返回的元素\r\n    reconcileChildren(fiber, fiber.stateNode.render());\r\n  } else {\r\n    reconcileChildren(fiber, fiber.props.children);\r\n  }\r\n  /**\r\n   * 如果子级存在 返回子级\r\n   * 将这个子级当作父级 构建这个父级下的子级\r\n   * 一直递归下去，能得到所有左侧节点的 fiber 对象\r\n   */\r\n  if (fiber.child) {\r\n    return fiber.child;\r\n  }\r\n\r\n  /**\r\n   * 如果有同级 返回同级\r\n   * 如果有父级 退回到父级,再看父级有没有同级\r\n   * 保证每个节点都找到了\r\n   */\r\n  let currentExecuterFiber = fiber;\r\n  while (currentExecuterFiber.parent) {\r\n    /**\r\n     * 使最外层的 effects 存储所有 fiber 对象\r\n     */\r\n    currentExecuterFiber.parent.effects =\r\n      currentExecuterFiber.parent.effects.concat(\r\n        currentExecuterFiber.effects.concat([currentExecuterFiber])\r\n      );\r\n\r\n    if (currentExecuterFiber.sibling) {\r\n      return currentExecuterFiber.sibling;\r\n    }\r\n    currentExecuterFiber = currentExecuterFiber.parent;\r\n  }\r\n\r\n  // 最外层 fiber 对象\r\n  pendingCommit = currentExecuterFiber;\r\n  // console.log(currentExecuterFiber);\r\n};\r\n\r\nconst workLoop = (deadline) => {\r\n  if (!subTask) {\r\n    // 若当前无任务，获取执行任务\r\n    subTask = getFirstTask();\r\n  }\r\n\r\n  // 当有任务并且空闲时间大于 1 ms 时执行任务\r\n  while (subTask && deadline.timeRemaining() > 1) {\r\n    // 执行任务 并返回一个新任务 while 执行\r\n    subTask = executeTask(subTask);\r\n  }\r\n\r\n  /**\r\n   * 判断\r\n   */\r\n  if (pendingCommit) {\r\n    commitAllWork(pendingCommit);\r\n  }\r\n};\r\n\r\nconst performTask = (deadline) => {\r\n  // 执行任务队列\r\n  workLoop(deadline);\r\n\r\n  /**\r\n   * 判断任务是否存在\r\n   * 当任务被中断时，需要重新判断执行的任务是否有中断\r\n   * 或者 taskQueue 有任务\r\n   * 告知浏览器在空闲时间继续执行\r\n   */\r\n  if (subTask || !taskQueue.isEmpty()) {\r\n    requestIdleCallback(performTask);\r\n  }\r\n};\r\n\r\nexport const render = (element, dom) => {\r\n  // 构建 Fiber 对象，从顶层开始\r\n  taskQueue.push({\r\n    dom,\r\n    props: { children: element },\r\n  });\r\n\r\n  // 浏览器空闲时间执行任务\r\n  requestIdleCallback(performTask);\r\n};\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React, { render, Component } from \"./react\";\r\n\r\nconst root = document.getElementById(\"root\");\r\n\r\nconst jsx = (\r\n  <div>\r\n    <p>Hello React</p>\r\n    <p>Hi fiber</p>\r\n  </div>\r\n);\r\n\r\n// render(jsx, root);\r\n\r\n/**\r\n * 渲染类组件\r\n */\r\nclass Grating extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    return <div>hahaha</div>;\r\n  }\r\n}\r\n\r\nrender(<Grating />, root);\r\n"],"names":["FIBER_TAG","ROOT","COMPONENT","CLASS_COMPONENT","FUNCTION_COMPONENT","EFFECT_TAG","PLACEMENT","VIRTUAL_DOM_TYPE","TEXT","Component","_createClass","props","_classCallCheck","createElement","type","_ref","_len","arguments","length","children","Array","_key","childElement","concat","apply","reduce","result","child","Object","push","textContent","assign","updateNodeElement","createDOMElement","virtualDOM","newElement","document","createTextNode","default","newProps","keys","forEach","propName","newPropsValue","slice","eventName","toLowerCase","addEventListener","setAttribute","arrified","arg","isArray","createTaskQueue","taskQueue","item","pop","shift","isEmpty","createReactInstance","fiber","instance","tag","createStateNode","getTag","getPrototypeOf","render","subTask","pendingCommit","commitAllWork","effects","f","effectTag","tempFiber","parentFiber","parent","stateNode","append","getFirstTask","task","dom","reconcileChildren","arrifiedChildren","index","childrenLength","element","newFiber","preFiber","sibling","executeTask","currentExecuterFiber","workLoop","deadline","timeRemaining","performTask","requestIdleCallback","React","root","getElementById","jsx","Grating","_Component","_callSuper","_inherits","key","value"],"sourceRoot":""}